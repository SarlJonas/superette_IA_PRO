<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sup√©rette IA PRO - Assistant Intelligent</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #0066FF;
            --primary-dark: #0052CC;
            --secondary: #00D4AA;
            --accent: #FF6B35;
            --warning: #FFB800;
            --danger: #FF4757;
            --dark: #0A1628;
            --dark-secondary: #1A2942;
            --dark-tertiary: #2A3F5F;
            --text-primary: #FFFFFF;
            --text-secondary: #8B9BB4;
            --glass: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--dark);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Animated Background */
        .bg-gradient {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(ellipse at 20% 20%, rgba(0, 102, 255, 0.15) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(0, 212, 170, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 50% 50%, rgba(255, 107, 53, 0.05) 0%, transparent 50%);
            z-index: -1;
            animation: gradientMove 20s ease infinite;
        }

        @keyframes gradientMove {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.1) rotate(5deg); }
        }

        /* Header */
        .header {
            padding: 1.5rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--glass-border);
            backdrop-filter: blur(20px);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.2rem;
            box-shadow: 0 4px 20px rgba(0, 102, 255, 0.4);
        }

        .logo-text {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--text-primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .logo-subtitle {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .header-actions {
            display: flex;
            gap: 1rem;
        }

        /* Main Container */
        .main-container {
            display: grid;
            grid-template-columns: 280px 1fr 350px;
            min-height: calc(100vh - 80px);
        }

        /* Sidebar */
        .sidebar {
            background: var(--glass);
            border-right: 1px solid var(--glass-border);
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .nav-item:hover {
            background: var(--glass);
            color: var(--text-primary);
        }

        .nav-item.active {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: var(--text-primary);
            box-shadow: 0 4px 15px rgba(0, 102, 255, 0.3);
        }

        .nav-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Content Area */
        .content {
            padding: 2rem;
            overflow-y: auto;
        }

        .section-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.75rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .section-title::before {
            content: '';
            width: 4px;
            height: 28px;
            background: linear-gradient(180deg, var(--primary), var(--secondary));
            border-radius: 2px;
        }

        /* Cards */
        .card {
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .card:hover {
            border-color: var(--primary);
            box-shadow: 0 8px 32px rgba(0, 102, 255, 0.15);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .card-title {
            font-weight: 600;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Upload Zone */
        .upload-zone {
            border: 2px dashed var(--glass-border);
            border-radius: 16px;
            padding: 3rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--glass);
        }

        .upload-zone:hover, .upload-zone.dragover {
            border-color: var(--primary);
            background: rgba(0, 102, 255, 0.1);
        }

        .upload-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 1rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
        }

        .upload-text {
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .upload-text strong {
            color: var(--text-primary);
            display: block;
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }

        /* Buttons */
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 10px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.95rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            box-shadow: 0 4px 15px rgba(0, 102, 255, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 102, 255, 0.4);
        }

        .btn-secondary {
            background: var(--glass);
            color: var(--text-primary);
            border: 1px solid var(--glass-border);
        }

        .btn-secondary:hover {
            background: var(--dark-tertiary);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--secondary), #00B894);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning), #F39C12);
            color: var(--dark);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #E84118);
            color: white;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 1.25rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }

        .stat-value {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        .stat-card.warning .stat-value { color: var(--warning); }
        .stat-card.danger .stat-value { color: var(--danger); }
        .stat-card.success .stat-value { color: var(--secondary); }

        /* Tables */
        .table-container {
            overflow-x: auto;
            border-radius: 12px;
            border: 1px solid var(--glass-border);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--glass-border);
        }

        th {
            background: var(--dark-secondary);
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            font-size: 0.75rem;
            letter-spacing: 1px;
        }

        tr:hover {
            background: var(--glass);
        }

        /* Badges */
        .badge {
            padding: 0.35rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
        }

        .badge-danger {
            background: rgba(255, 71, 87, 0.2);
            color: var(--danger);
        }

        .badge-warning {
            background: rgba(255, 184, 0, 0.2);
            color: var(--warning);
        }

        .badge-success {
            background: rgba(0, 212, 170, 0.2);
            color: var(--secondary);
        }

        /* Chat Panel */
        .chat-panel {
            background: var(--dark-secondary);
            border-left: 1px solid var(--glass-border);
            display: flex;
            flex-direction: column;
            height: calc(100vh - 80px);
        }

        .chat-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--glass-border);
        }

        .chat-title {
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .chat-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
            font-size: 0.85rem;
            color: var(--secondary);
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background: var(--secondary);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .message {
            max-width: 90%;
            padding: 1rem;
            border-radius: 16px;
            animation: messageIn 0.3s ease;
        }

        @keyframes messageIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message.user {
            background: var(--primary);
            align-self: flex-end;
            border-bottom-right-radius: 4px;
        }

        .message.assistant {
            background: var(--dark-tertiary);
            align-self: flex-start;
            border-bottom-left-radius: 4px;
        }

        .message-time {
            font-size: 0.7rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }

        .chat-input-container {
            padding: 1rem;
            border-top: 1px solid var(--glass-border);
        }

        .chat-input-wrapper {
            display: flex;
            gap: 0.5rem;
            background: var(--dark);
            border-radius: 12px;
            padding: 0.5rem;
            border: 1px solid var(--glass-border);
        }

        .chat-input {
            flex: 1;
            background: none;
            border: none;
            color: var(--text-primary);
            padding: 0.75rem;
            font-size: 0.95rem;
            outline: none;
        }

        .chat-input::placeholder {
            color: var(--text-secondary);
        }

        .send-btn {
            width: 44px;
            height: 44px;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .send-btn:hover {
            transform: scale(1.05);
        }

        /* Marketing Generator */
        .marketing-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .marketing-card {
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .marketing-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
        }

        .marketing-card-header {
            padding: 1rem 1.5rem;
            background: var(--dark-tertiary);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 600;
        }

        .marketing-card-body {
            padding: 1.5rem;
        }

        .marketing-preview {
            background: var(--dark);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            line-height: 1.6;
            max-height: 200px;
            overflow-y: auto;
        }

        /* Alerts List */
        .alerts-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .alert-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: var(--glass);
            border-radius: 12px;
            border-left: 4px solid var(--danger);
        }

        .alert-item.warning { border-left-color: var(--warning); }
        .alert-item.info { border-left-color: var(--primary); }

        .alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 71, 87, 0.2);
        }

        .alert-item.warning .alert-icon { background: rgba(255, 184, 0, 0.2); }

        .alert-content {
            flex: 1;
        }

        .alert-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .alert-desc {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        /* Progress Bar */
        .progress-bar {
            height: 8px;
            background: var(--dark);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 0.5rem;
        }

        .progress-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .progress-fill.danger { background: var(--danger); }
        .progress-fill.warning { background: var(--warning); }
        .progress-fill.success { background: var(--secondary); }

        /* Hidden */
        .hidden { display: none !important; }

        /* Loading */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--glass-border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .main-container {
                grid-template-columns: 1fr;
            }
            .sidebar, .chat-panel {
                display: none;
            }
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .quick-action-btn {
            padding: 0.5rem 1rem;
            background: var(--dark-tertiary);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
        }

        .quick-action-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* Product Card */
        .product-highlight {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: linear-gradient(135deg, rgba(0, 102, 255, 0.1), rgba(0, 212, 170, 0.1));
            border-radius: 12px;
            margin-bottom: 1rem;
        }

        .product-image {
            width: 60px;
            height: 60px;
            background: var(--dark-tertiary);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .product-info h4 {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .product-info p {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        /* Textarea */
        textarea {
            width: 100%;
            background: var(--dark);
            border: 1px solid var(--glass-border);
            border-radius: 10px;
            padding: 1rem;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 0.95rem;
            resize: vertical;
            min-height: 120px;
        }

        textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid var(--glass-border);
            padding-bottom: 0.5rem;
        }

        .tab {
            padding: 0.75rem 1.25rem;
            cursor: pointer;
            color: var(--text-secondary);
            border-radius: 8px 8px 0 0;
            transition: all 0.3s ease;
        }

        .tab:hover {
            color: var(--text-primary);
        }

        .tab.active {
            background: var(--primary);
            color: white;
        }
    </style>
</head>
<body>
    <div class="bg-gradient"></div>

    <!-- Header -->
    <header class="header">
        <div class="logo">
            <div class="logo-icon">JB</div>
            <div>
                <div class="logo-text">Sup√©rette IA PRO</div>
                <div class="logo-subtitle">SARL Jonas Browser High-Tech</div>
            </div>
        </div>
        <div class="header-actions">
            <button class="btn btn-secondary" onclick="downloadExemple()">
                üì• T√©l√©charger CSV Exemple
            </button>
            <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">
                üì§ Importer Donn√©es
            </button>
            <input type="file" id="fileInput" accept=".csv,.xlsx,.xls" style="display:none" onchange="handleFileUpload(event)">
        </div>
    </header>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="nav-item active" onclick="showSection('dashboard')">
                <div class="nav-icon">üìä</div>
                <span>Tableau de bord</span>
            </div>
            <div class="nav-item" onclick="showSection('stock')">
                <div class="nav-icon">üì¶</div>
                <span>Gestion Stock</span>
            </div>
            <div class="nav-item" onclick="showSection('marketing')">
                <div class="nav-icon">üì£</div>
                <span>Marketing Auto</span>
            </div>
            <div class="nav-item" onclick="showSection('alerts')">
                <div class="nav-icon">‚ö†Ô∏è</div>
                <span>Alertes DLC</span>
            </div>
            <div class="nav-item" onclick="showSection('reports')">
                <div class="nav-icon">üìà</div>
                <span>Rapports</span>
            </div>
            <div class="nav-item" onclick="showSection('settings')">
                <div class="nav-icon">‚öôÔ∏è</div>
                <span>Param√®tres</span>
            </div>
        </aside>

        <!-- Content -->
        <main class="content">
            <!-- Dashboard Section -->
            <section id="section-dashboard" class="section">
                <h2 class="section-title">Tableau de bord</h2>
                
                <!-- Upload Zone (shown when no data) -->
                <div id="uploadZone" class="upload-zone" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)" ondrop="handleDrop(event)" onclick="document.getElementById('fileInput').click()">
                    <div class="upload-icon">üìä</div>
                    <div class="upload-text">
                        <strong>Importez vos donn√©es de vente</strong>
                        Glissez-d√©posez votre fichier CSV ou Excel ici<br>
                        ou cliquez pour s√©lectionner
                    </div>
                    <button class="btn btn-primary" onclick="event.stopPropagation(); downloadExemple()">
                        üì• T√©l√©charger le fichier exemple
                    </button>
                </div>

                <!-- Stats (shown when data loaded) -->
                <div id="statsContainer" class="hidden">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="statTotalVentes">0 ‚Ç¨</div>
                            <div class="stat-label">Chiffre d'affaires</div>
                        </div>
                        <div class="stat-card success">
                            <div class="stat-value" id="statProduits">0</div>
                            <div class="stat-label">Produits actifs</div>
                        </div>
                        <div class="stat-card warning">
                            <div class="stat-value" id="statAlertesStock">0</div>
                            <div class="stat-label">Alertes stock bas</div>
                        </div>
                        <div class="stat-card danger">
                            <div class="stat-value" id="statAlertesDLC">0</div>
                            <div class="stat-label">DLC proches</div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">üèÜ Top Produits Vendus</h3>
                            <span class="badge badge-success">Cette semaine</span>
                        </div>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Produit</th>
                                        <th>Cat√©gorie</th>
                                        <th>Quantit√©</th>
                                        <th>CA</th>
                                        <th>Tendance</th>
                                    </tr>
                                </thead>
                                <tbody id="topProductsTable">
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">üê¢ Produits √† Faible Rotation</h3>
                            <button class="btn btn-warning btn-sm" onclick="generatePromoForSlowProducts()">G√©n√©rer Promo</button>
                        </div>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Produit</th>
                                        <th>Stock</th>
                                        <th>Ventes/jour</th>
                                        <th>DLC</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody id="slowProductsTable">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Stock Section -->
            <section id="section-stock" class="section hidden">
                <h2 class="section-title">Gestion Intelligente du Stock</h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="stockTotal">0</div>
                        <div class="stat-label">Unit√©s en stock</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-value" id="stockBas">0</div>
                        <div class="stat-label">Stock bas</div>
                    </div>
                    <div class="stat-card danger">
                        <div class="stat-value" id="stockCritique">0</div>
                        <div class="stat-label">Stock critique</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üì¶ √âtat du Stock</h3>
                        <div>
                            <button class="btn btn-secondary btn-sm" onclick="exportStock()">Exporter</button>
                            <button class="btn btn-primary btn-sm" onclick="generateOrderSuggestions()">Suggestions Commande</button>
                        </div>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Produit</th>
                                    <th>Stock Actuel</th>
                                    <th>Ventes Moy/Jour</th>
                                    <th>Jours Restants</th>
                                    <th>DLC</th>
                                    <th>Statut</th>
                                </tr>
                            </thead>
                            <tbody id="stockTable">
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Marketing Section -->
            <section id="section-marketing" class="section hidden">
                <h2 class="section-title">Automatisation Marketing</h2>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üéØ Produits √† Promouvoir</h3>
                    </div>
                    <div id="productsToPromote" class="alerts-list">
                        <p class="text-muted">Importez des donn√©es pour voir les suggestions</p>
                    </div>
                </div>

                <div class="marketing-grid">
                    <!-- WhatsApp -->
                    <div class="marketing-card">
                        <div class="marketing-card-header">
                            <span style="color: #25D366;">üì±</span> Message WhatsApp
                        </div>
                        <div class="marketing-card-body">
                            <div class="marketing-preview" id="whatsappPreview">
                                üõí *PROMO DU JOUR* üõí

Bonjour ! Votre sup√©rette vous propose aujourd'hui :

üî• -20% sur [Produit]
üìç Valable aujourd'hui uniquement

√Ä tr√®s vite ! üôã‚Äç‚ôÄÔ∏è
                            </div>
                            <div style="display: flex; gap: 0.5rem;">
                                <button class="btn btn-success" onclick="generateWhatsApp()">G√©n√©rer</button>
                                <button class="btn btn-secondary" onclick="copyToClipboard('whatsappPreview')">Copier</button>
                            </div>
                        </div>
                    </div>

                    <!-- SMS -->
                    <div class="marketing-card">
                        <div class="marketing-card-header">
                            <span>üí¨</span> SMS Promotionnel
                        </div>
                        <div class="marketing-card-body">
                            <div class="marketing-preview" id="smsPreview">
PROMO: -20% sur [Produit] aujourd'hui! Votre superette vous attend. STOP au 36123
                            </div>
                            <div style="display: flex; gap: 0.5rem;">
                                <button class="btn btn-primary" onclick="generateSMS()">G√©n√©rer</button>
                                <button class="btn btn-secondary" onclick="copyToClipboard('smsPreview')">Copier</button>
                            </div>
                        </div>
                    </div>

                    <!-- Facebook -->
                    <div class="marketing-card">
                        <div class="marketing-card-header">
                            <span style="color: #1877F2;">üìò</span> Post Facebook
                        </div>
                        <div class="marketing-card-body">
                            <div class="marketing-preview" id="facebookPreview">
üéâ OFFRE SP√âCIALE DU JOUR üéâ

Profitez de -20% sur [Produit] !

‚úÖ Qualit√© garantie
‚úÖ Prix imbattable  
‚úÖ Stock limit√©

üìç Passez nous voir aujourd'hui !

#promo #superette #bonplan #economie
                            </div>
                            <div style="display: flex; gap: 0.5rem;">
                                <button class="btn btn-primary" onclick="generateFacebook()">G√©n√©rer</button>
                                <button class="btn btn-secondary" onclick="copyToClipboard('facebookPreview')">Copier</button>
                            </div>
                        </div>
                    </div>

                    <!-- Affiche -->
                    <div class="marketing-card">
                        <div class="marketing-card-header">
                            <span>üñ®Ô∏è</span> Affiche Promotionnelle
                        </div>
                        <div class="marketing-card-body">
                            <div class="marketing-preview" id="affichePreview" style="text-align: center; font-weight: bold;">
                                <div style="font-size: 1.5rem; color: var(--danger);">üî• PROMO üî•</div>
                                <div style="font-size: 1.8rem; margin: 1rem 0;">[Produit]</div>
                                <div style="font-size: 2.5rem; color: var(--secondary);">-20%</div>
                                <div style="margin-top: 1rem; font-size: 0.9rem;">Offre valable aujourd'hui uniquement</div>
                            </div>
                            <div style="display: flex; gap: 0.5rem;">
                                <button class="btn btn-primary" onclick="generateAffiche()">G√©n√©rer PDF</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Alerts Section -->
            <section id="section-alerts" class="section hidden">
                <h2 class="section-title">Alertes DLC & P√©remption</h2>
                
                <div class="tabs">
                    <div class="tab active" onclick="filterAlerts('all')">Toutes</div>
                    <div class="tab" onclick="filterAlerts('critical')">Critiques</div>
                    <div class="tab" onclick="filterAlerts('warning')">Attention</div>
                </div>

                <div id="alertsList" class="alerts-list">
                    <p class="text-muted">Importez des donn√©es pour voir les alertes</p>
                </div>
            </section>

            <!-- Reports Section -->
            <section id="section-reports" class="section hidden">
                <h2 class="section-title">Rapports & Analyses</h2>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üìä Rapport de Performance</h3>
                    </div>
                    <div id="reportContent">
                        <p>Importez des donn√©es pour g√©n√©rer un rapport.</p>
                    </div>
                </div>
            </section>

            <!-- Settings Section -->
            <section id="section-settings" class="section hidden">
                <h2 class="section-title">Param√®tres</h2>
                
                <div class="card">
                    <h3 class="card-title">üè™ Informations Sup√©rette</h3>
                    <div style="display: grid; gap: 1rem; margin-top: 1rem;">
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary);">Nom de la sup√©rette</label>
                            <input type="text" id="shopName" placeholder="Ma Sup√©rette" style="width: 100%; padding: 0.75rem; background: var(--dark); border: 1px solid var(--glass-border); border-radius: 8px; color: white;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary);">T√©l√©phone WhatsApp</label>
                            <input type="text" id="shopPhone" placeholder="+33 6 XX XX XX XX" style="width: 100%; padding: 0.75rem; background: var(--dark); border: 1px solid var(--glass-border); border-radius: 8px; color: white;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary);">Seuil alerte stock bas (jours)</label>
                            <input type="number" id="stockThreshold" value="7" style="width: 100%; padding: 0.75rem; background: var(--dark); border: 1px solid var(--glass-border); border-radius: 8px; color: white;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary);">Seuil alerte DLC (jours)</label>
                            <input type="number" id="dlcThreshold" value="5" style="width: 100%; padding: 0.75rem; background: var(--dark); border: 1px solid var(--glass-border); border-radius: 8px; color: white;">
                        </div>
                        <button class="btn btn-primary" onclick="saveSettings()">Enregistrer</button>
                    </div>
                </div>
            </section>
        </main>

        <!-- Chat Panel -->
        <aside class="chat-panel">
            <div class="chat-header">
                <div class="chat-title">ü§ñ Assistant IA G√©rant</div>
                <div class="chat-status">
                    <div class="status-dot"></div>
                    En ligne - Pr√™t √† vous aider
                </div>
            </div>
            <div class="chat-messages" id="chatMessages">
                <div class="message assistant">
                    Bonjour ! Je suis votre assistant IA. Je peux vous aider √† :
                    <br><br>
                    ‚Ä¢ Analyser vos ventes<br>
                    ‚Ä¢ Sugg√©rer des promotions<br>
                    ‚Ä¢ G√©rer votre stock<br>
                    ‚Ä¢ Cr√©er du contenu marketing
                    <br><br>
                    Importez vos donn√©es pour commencer !
                    <div class="message-time">Maintenant</div>
                </div>
            </div>
            <div class="quick-actions">
                <button class="quick-action-btn" onclick="askAssistant('Quels produits dois-je promouvoir ?')">üéØ Produits √† promouvoir</button>
                <button class="quick-action-btn" onclick="askAssistant('Quel est le bilan du jour ?')">üìä Bilan du jour</button>
                <button class="quick-action-btn" onclick="askAssistant('Quelles alertes stock ?')">‚ö†Ô∏è Alertes</button>
            </div>
            <div class="chat-input-container">
                <div class="chat-input-wrapper">
                    <input type="text" class="chat-input" id="chatInput" placeholder="Posez votre question..." onkeypress="if(event.key==='Enter')sendMessage()">
                    <button class="send-btn" onclick="sendMessage()">‚û§</button>
                </div>
            </div>
        </aside>
    </div>

    <script>
        // Global Data Store
        let salesData = [];
        let productsData = {};
        let settings = {
            shopName: 'Ma Sup√©rette',
            shopPhone: '',
            stockThreshold: 7,
            dlcThreshold: 5
        };

        // File Upload Handlers
        function handleDragOver(e) {
            e.preventDefault();
            e.target.closest('.upload-zone').classList.add('dragover');
        }

        function handleDragLeave(e) {
            e.preventDefault();
            e.target.closest('.upload-zone').classList.remove('dragover');
        }

        function handleDrop(e) {
            e.preventDefault();
            e.target.closest('.upload-zone').classList.remove('dragover');
            const file = e.dataTransfer.files[0];
            if (file) processFile(file);
        }

        function handleFileUpload(e) {
            const file = e.target.files[0];
            if (file) processFile(file);
        }

        function processFile(file) {
            const extension = file.name.split('.').pop().toLowerCase();
            
            if (extension === 'csv') {
                Papa.parse(file, {
                    header: true,
                    complete: function(results) {
                        salesData = results.data.filter(row => row.code_produit);
                        processData();
                    }
                });
            } else if (['xlsx', 'xls'].includes(extension)) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const workbook = XLSX.read(e.target.result, { type: 'binary' });
                    const sheetName = workbook.SheetNames[0];
                    const sheet = workbook.Sheets[sheetName];
                    salesData = XLSX.utils.sheet_to_json(sheet);
                    processData();
                };
                reader.readAsBinaryString(file);
            }
        }

        function processData() {
            // Aggregate data by product
            productsData = {};
            
            salesData.forEach(row => {
                const code = row.code_produit;
                if (!productsData[code]) {
                    productsData[code] = {
                        code: code,
                        nom: row.nom_produit,
                        categorie: row.categorie,
                        prix: parseFloat(row.prix_unitaire) || 0,
                        totalQte: 0,
                        totalCA: 0,
                        stock: parseInt(row.stock_actuel) || 0,
                        dlc: row.date_peremption,
                        fournisseur: row.fournisseur,
                        dates: []
                    };
                }
                const qte = parseInt(row.quantite_vendue) || 0;
                productsData[code].totalQte += qte;
                productsData[code].totalCA += qte * productsData[code].prix;
                productsData[code].dates.push(row.date_vente);
                productsData[code].stock = parseInt(row.stock_actuel) || productsData[code].stock;
            });

            // Calculate average daily sales
            Object.values(productsData).forEach(p => {
                const uniqueDays = [...new Set(p.dates)].length || 1;
                p.avgDaily = p.totalQte / uniqueDays;
                p.daysLeft = p.avgDaily > 0 ? Math.round(p.stock / p.avgDaily) : 999;
                
                // Calculate days until DLC
                if (p.dlc) {
                    const dlcDate = new Date(p.dlc);
                    const today = new Date();
                    p.dlcDays = Math.ceil((dlcDate - today) / (1000 * 60 * 60 * 24));
                } else {
                    p.dlcDays = 999;
                }
            });

            updateDashboard();
            updateStockTable();
            updateAlerts();
            
            // Show data containers
            document.getElementById('uploadZone').classList.add('hidden');
            document.getElementById('statsContainer').classList.remove('hidden');
            
            // Send chat message
            addChatMessage('assistant', `‚úÖ Donn√©es import√©es avec succ√®s !\n\nüìä ${Object.keys(productsData).length} produits analys√©s\nüí∞ CA Total: ${formatCurrency(getTotalCA())}\n‚ö†Ô∏è ${getAlertsCount()} alertes √† traiter\n\nComment puis-je vous aider ?`);
        }

        function updateDashboard() {
            const products = Object.values(productsData);
            
            // Stats
            document.getElementById('statTotalVentes').textContent = formatCurrency(getTotalCA());
            document.getElementById('statProduits').textContent = products.length;
            document.getElementById('statAlertesStock').textContent = products.filter(p => p.daysLeft < settings.stockThreshold).length;
            document.getElementById('statAlertesDLC').textContent = products.filter(p => p.dlcDays < settings.dlcThreshold).length;

            // Top products table
            const topProducts = [...products].sort((a, b) => b.totalQte - a.totalQte).slice(0, 5);
            const topTable = document.getElementById('topProductsTable');
            topTable.innerHTML = topProducts.map(p => `
                <tr>
                    <td><strong>${p.nom}</strong></td>
                    <td>${p.categorie}</td>
                    <td>${p.totalQte}</td>
                    <td>${formatCurrency(p.totalCA)}</td>
                    <td><span class="badge badge-success">üìà Tendance +</span></td>
                </tr>
            `).join('');

            // Slow products table
            const slowProducts = [...products].sort((a, b) => a.avgDaily - b.avgDaily).slice(0, 5);
            const slowTable = document.getElementById('slowProductsTable');
            slowTable.innerHTML = slowProducts.map(p => `
                <tr>
                    <td><strong>${p.nom}</strong></td>
                    <td>${p.stock}</td>
                    <td>${p.avgDaily.toFixed(1)}</td>
                    <td><span class="badge ${p.dlcDays < 5 ? 'badge-danger' : p.dlcDays < 10 ? 'badge-warning' : 'badge-success'}">${p.dlcDays}j</span></td>
                    <td><button class="btn btn-warning btn-sm" onclick="generatePromoFor('${p.code}')">Promouvoir</button></td>
                </tr>
            `).join('');

            // Products to promote
            const toPromote = products.filter(p => p.dlcDays < 10 || p.avgDaily < 2).slice(0, 5);
            document.getElementById('productsToPromote').innerHTML = toPromote.map(p => `
                <div class="product-highlight">
                    <div class="product-image">üõí</div>
                    <div class="product-info">
                        <h4>${p.nom}</h4>
                        <p>Stock: ${p.stock} | DLC: ${p.dlcDays}j | Ventes: ${p.avgDaily.toFixed(1)}/jour</p>
                    </div>
                    <button class="btn btn-primary btn-sm" onclick="generatePromoFor('${p.code}')">Promouvoir</button>
                </div>
            `).join('');
        }

        function updateStockTable() {
            const products = Object.values(productsData);
            
            document.getElementById('stockTotal').textContent = products.reduce((sum, p) => sum + p.stock, 0);
            document.getElementById('stockBas').textContent = products.filter(p => p.daysLeft < 7 && p.daysLeft >= 3).length;
            document.getElementById('stockCritique').textContent = products.filter(p => p.daysLeft < 3).length;

            const stockTable = document.getElementById('stockTable');
            stockTable.innerHTML = [...products].sort((a, b) => a.daysLeft - b.daysLeft).map(p => {
                let statusClass = 'success';
                let statusText = 'OK';
                if (p.daysLeft < 3) { statusClass = 'danger'; statusText = 'Critique'; }
                else if (p.daysLeft < 7) { statusClass = 'warning'; statusText = 'Bas'; }
                
                return `
                    <tr>
                        <td><strong>${p.nom}</strong></td>
                        <td>${p.stock}</td>
                        <td>${p.avgDaily.toFixed(1)}</td>
                        <td>${p.daysLeft}</td>
                        <td><span class="badge ${p.dlcDays < 5 ? 'badge-danger' : p.dlcDays < 10 ? 'badge-warning' : 'badge-success'}">${p.dlcDays}j</span></td>
                        <td><span class="badge badge-${statusClass}">${statusText}</span></td>
                    </tr>
                `;
            }).join('');
        }

        function updateAlerts() {
            const products = Object.values(productsData);
            const alerts = products
                .filter(p => p.dlcDays < 10)
                .sort((a, b) => a.dlcDays - b.dlcDays);

            document.getElementById('alertsList').innerHTML = alerts.map(p => {
                const isCritical = p.dlcDays < 3;
                return `
                    <div class="alert-item ${isCritical ? '' : 'warning'}">
                        <div class="alert-icon">${isCritical ? 'üö®' : '‚ö†Ô∏è'}</div>
                        <div class="alert-content">
                            <div class="alert-title">${p.nom}</div>
                            <div class="alert-desc">DLC dans ${p.dlcDays} jours | Stock: ${p.stock} unit√©s</div>
                        </div>
                        <button class="btn btn-${isCritical ? 'danger' : 'warning'} btn-sm" onclick="generatePromoFor('${p.code}')">
                            Cr√©er Promo
                        </button>
                    </div>
                `;
            }).join('') || '<p style="color: var(--text-secondary); text-align: center; padding: 2rem;">Aucune alerte DLC</p>';
        }

        // Marketing Generation
        function generatePromoFor(code) {
            const product = productsData[code];
            if (!product) return;

            const discount = product.dlcDays < 3 ? 50 : product.dlcDays < 5 ? 30 : 20;
            
            document.getElementById('whatsappPreview').textContent = `üõí *PROMO FLASH* üõí

Bonjour ! Votre sup√©rette ${settings.shopName} vous propose :

üî• *-${discount}% sur ${product.nom}*
üí∞ Prix: ${formatCurrency(product.prix * (1 - discount/100))} au lieu de ${formatCurrency(product.prix)}

üìç Offre valable jusqu'√† √©puisement du stock !

√Ä tr√®s vite ! üôã‚Äç‚ôÄÔ∏è`;

            document.getElementById('smsPreview').textContent = `PROMO -${discount}% ${product.nom} √† ${formatCurrency(product.prix * (1 - discount/100))}! ${settings.shopName}. Offre limit√©e! STOP 36123`;

            document.getElementById('facebookPreview').innerHTML = `üéâ PROMO EXCEPTIONNELLE üéâ

<strong>-${discount}% sur ${product.nom}</strong>

‚úÖ Prix exceptionnel : ${formatCurrency(product.prix * (1 - discount/100))}
‚úÖ Au lieu de ${formatCurrency(product.prix)}
‚úÖ Stock limit√© - Faites vite !

üìç ${settings.shopName} vous attend !

#promo #superette #bonplan #${product.categorie.toLowerCase().replace(/ /g, '')}`;

            showSection('marketing');
            addChatMessage('assistant', `üì£ J'ai pr√©par√© une promotion pour *${product.nom}* avec -${discount}% !\n\nVous pouvez personnaliser et copier les messages dans la section Marketing.`);
        }

        function generateWhatsApp() {
            const slowProducts = Object.values(productsData)
                .filter(p => p.dlcDays < 10)
                .slice(0, 3);
            
            if (slowProducts.length === 0) {
                addChatMessage('assistant', '‚ö†Ô∏è Aucun produit √† promouvoir d√©tect√©. Importez des donn√©es avec des DLC proches.');
                return;
            }

            const promos = slowProducts.map(p => {
                const discount = p.dlcDays < 3 ? 50 : p.dlcDays < 5 ? 30 : 20;
                return `üî• -${discount}% *${p.nom}*`;
            }).join('\n');

            document.getElementById('whatsappPreview').textContent = `üõí *PROMOS DU JOUR* üõí

Bonjour ! Votre sup√©rette vous propose aujourd'hui :

${promos}

üìç Offres valables aujourd'hui uniquement !

√Ä tr√®s vite ! üôã‚Äç‚ôÄÔ∏è`;
        }

        function generateSMS() {
            const product = Object.values(productsData).find(p => p.dlcDays < 10);
            if (product) {
                const discount = product.dlcDays < 3 ? 50 : 20;
                document.getElementById('smsPreview').textContent = `PROMO: -${discount}% sur ${product.nom} aujourd'hui! ${settings.shopName} vous attend. STOP 36123`;
            }
        }

        function generateFacebook() {
            const slowProducts = Object.values(productsData)
                .filter(p => p.dlcDays < 10)
                .slice(0, 3);
            
            const promos = slowProducts.map(p => {
                const discount = p.dlcDays < 3 ? 50 : 20;
                return `‚úÖ -${discount}% ${p.nom}`;
            }).join('\n');

            document.getElementById('facebookPreview').innerHTML = `üéâ OFFRES SP√âCIALES DU JOUR üéâ

Profitez de nos promotions exceptionnelles !

${promos || '‚úÖ D√©couvrez nos offres en magasin'}

üìç ${settings.shopName || 'Votre sup√©rette'} vous attend !

#promo #superette #bonplan #economie`;
        }

        function generateAffiche() {
            const product = Object.values(productsData).find(p => p.dlcDays < 10);
            if (product) {
                const discount = product.dlcDays < 3 ? 50 : 20;
                alert(`Affiche PDF g√©n√©r√©e pour ${product.nom} avec -${discount}%\n\n(Dans la version compl√®te, un PDF serait t√©l√©charg√©)`);
            }
        }

        // Chat Assistant
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            if (!message) return;

            addChatMessage('user', message);
            input.value = '';

            // Simulate AI response
            setTimeout(() => {
                const response = generateAIResponse(message);
                addChatMessage('assistant', response);
            }, 500);
        }

        function askAssistant(question) {
            document.getElementById('chatInput').value = question;
            sendMessage();
        }

        function addChatMessage(type, content) {
            const container = document.getElementById('chatMessages');
            const time = new Date().toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' });
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            messageDiv.innerHTML = `${content.replace(/\n/g, '<br>')}<div class="message-time">${time}</div>`;
            
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
        }

        function generateAIResponse(question) {
            const q = question.toLowerCase();
            const products = Object.values(productsData);
            
            if (products.length === 0) {
                return "üìä Veuillez d'abord importer vos donn√©es de vente pour que je puisse vous aider.";
            }

            if (q.includes('promouvoir') || q.includes('promo')) {
                const toPromote = products.filter(p => p.dlcDays < 10).slice(0, 3);
                if (toPromote.length > 0) {
                    return `üéØ Voici les produits √† promouvoir en priorit√© :\n\n${toPromote.map(p => `‚Ä¢ ${p.nom} (DLC: ${p.dlcDays}j)`).join('\n')}\n\nJe vous recommande de cr√©er des promotions flash pour √©couler ces stocks rapidement.`;
                }
                return "‚úÖ Aucun produit n'a besoin d'√™tre promu en urgence actuellement.";
            }

            if (q.includes('bilan') || q.includes('r√©sum√©') || q.includes('jour')) {
                const alertCount = products.filter(p => p.dlcDays < 10).length;
                const lowStock = products.filter(p => p.daysLeft < 7).length;
                return `üìä *Bilan du jour*\n\nüí∞ CA Total: ${formatCurrency(getTotalCA())}\nüì¶ Produits: ${products.length}\n‚ö†Ô∏è Alertes DLC: ${alertCount}\nüìâ Stock bas: ${lowStock}\n\n${alertCount > 0 ? 'üëâ Je vous recommande de cr√©er des promotions pour les produits avec DLC proche.' : '‚úÖ Tout semble en ordre !'}`;
            }

            if (q.includes('alerte') || q.includes('stock') || q.includes('dlc')) {
                const alerts = products.filter(p => p.dlcDays < 10 || p.daysLeft < 7);
                if (alerts.length > 0) {
                    return `‚ö†Ô∏è *${alerts.length} alertes actives*\n\n${alerts.slice(0, 5).map(p => `‚Ä¢ ${p.nom}: DLC ${p.dlcDays}j, Stock ${p.stock}`).join('\n')}\n\nVoulez-vous que je g√©n√®re des promotions ?`;
                }
                return "‚úÖ Aucune alerte de stock ou DLC actuellement.";
            }

            if (q.includes('vente') || q.includes('meilleur') || q.includes('top')) {
                const top = [...products].sort((a, b) => b.totalQte - a.totalQte).slice(0, 5);
                return `üèÜ *Top 5 des ventes*\n\n${top.map((p, i) => `${i + 1}. ${p.nom}: ${p.totalQte} unit√©s`).join('\n')}`;
            }

            return `Je comprends votre question sur "${question}". Pour une analyse plus pr√©cise, n'h√©sitez pas √† me demander :\n\n‚Ä¢ Les produits √† promouvoir\n‚Ä¢ Le bilan du jour\n‚Ä¢ Les alertes stock/DLC\n‚Ä¢ Les meilleures ventes`;
        }

        // Utility Functions
        function formatCurrency(amount) {
            return new Intl.NumberFormat('fr-FR', { style: 'currency', currency: 'EUR' }).format(amount);
        }

        function getTotalCA() {
            return Object.values(productsData).reduce((sum, p) => sum + p.totalCA, 0);
        }

        function getAlertsCount() {
            return Object.values(productsData).filter(p => p.dlcDays < 10).length;
        }

        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
            document.getElementById(`section-${sectionId}`).classList.remove('hidden');
            
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            event.target.closest('.nav-item')?.classList.add('active');
        }

        function copyToClipboard(elementId) {
            const text = document.getElementById(elementId).textContent;
            navigator.clipboard.writeText(text).then(() => {
                alert('Copi√© dans le presse-papier !');
            });
        }

        function downloadExemple() {
            const csvContent = `code_produit,nom_produit,categorie,prix_unitaire,quantite_vendue,date_vente,stock_actuel,date_peremption,fournisseur
001,Lait entier 1L,Produits laitiers,1.20,45,2025-01-15,12,2025-01-25,Lactalis
002,Pain de mie,Boulangerie,2.50,30,2025-01-15,8,2025-01-20,Harry's
003,Coca-Cola 1.5L,Boissons,2.10,60,2025-01-15,25,2025-06-30,Coca-Cola
004,Yaourt nature x4,Produits laitiers,1.80,25,2025-01-15,15,2025-01-22,Danone
005,Bananes 1kg,Fruits et l√©gumes,1.90,40,2025-01-15,10,2025-01-19,Local`;
            
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'exemple_ventes_superette.csv';
            link.click();
        }

        function saveSettings() {
            settings.shopName = document.getElementById('shopName').value;
            settings.shopPhone = document.getElementById('shopPhone').value;
            settings.stockThreshold = parseInt(document.getElementById('stockThreshold').value);
            settings.dlcThreshold = parseInt(document.getElementById('dlcThreshold').value);
            alert('Param√®tres enregistr√©s !');
        }

        function filterAlerts(type) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            // Filter logic would go here
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Load settings from localStorage if available
            const saved = localStorage.getItem('superetteSettings');
            if (saved) {
                settings = { ...settings, ...JSON.parse(saved) };
                document.getElementById('shopName').value = settings.shopName;
                document.getElementById('shopPhone').value = settings.shopPhone;
                document.getElementById('stockThreshold').value = settings.stockThreshold;
                document.getElementById('dlcThreshold').value = settings.dlcThreshold;
            }
        });
    </script>
</body>
</html>
